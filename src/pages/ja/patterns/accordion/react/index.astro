---
import PatternLayout from '../../../../../layouts/PatternLayout.astro';
import Accordion from '@patterns/accordion/Accordion';
import CodeBlock from '@/components/ui/CodeBlock.astro';
import ExternalLink from '@/components/ui/ExternalLink.astro';
import AccessibilityDocs from '@patterns/accordion/AccessibilityDocs.ja.astro';
import TestingDocs from '@patterns/accordion/TestingDocs.ja.astro';
import FrameworkTabs from '@/components/ui/FrameworkTabs.astro';
import { ResponsiveTable } from '@/components/ui/table';
import Heading from '@/components/ui/Heading.astro';
import sourceCode from '@patterns/accordion/Accordion.tsx?raw';
import testCode from '@patterns/accordion/Accordion.test.tsx?raw';
import { useTranslation } from '@/i18n';

const locale = 'ja';
const t = useTranslation(locale);

const tocItems = [
  { id: 'demo', text: t('pattern.demo') },
  { id: 'accessibility-features', text: t('pattern.accessibility') },
  { id: 'source-code', text: t('pattern.sourceCode') },
  { id: 'usage', text: t('pattern.usage') },
  { id: 'api', text: t('pattern.api') },
  { id: 'testing', text: t('pattern.testing') },
  { id: 'resources', text: t('pattern.resources') },
];

const defaultItems = [
  {
    id: 'section1',
    header: 'What is an Accordion?',
    content:
      'An accordion is a vertically stacked set of interactive headings that each reveal a section of content. They are commonly used to reduce the need to scroll when presenting multiple sections of content on a single page.',
    defaultExpanded: true,
  },
  {
    id: 'section2',
    header: 'When to use an Accordion?',
    content:
      'Use accordions when you need to organize content into collapsible sections. This helps reduce visual clutter while keeping information accessible. They are particularly useful for FAQs, settings panels, and navigation menus.',
  },
  {
    id: 'section3',
    header: 'Accessibility Considerations',
    content:
      'Accordions must be keyboard accessible and properly announce their expanded/collapsed state to screen readers. Each header should be a proper heading element, and the panel should be associated with its header via aria-controls and aria-labelledby.',
  },
];

const multipleItems = [
  {
    id: 'multi1',
    header: 'Section One',
    content:
      'Content for section one. With allowMultiple enabled, multiple sections can be open at the same time.',
  },
  {
    id: 'multi2',
    header: 'Section Two',
    content: 'Content for section two. Try opening this while section one is still open.',
  },
  {
    id: 'multi3',
    header: 'Section Three',
    content: 'Content for section three. All three sections can be expanded simultaneously.',
  },
];

const disabledItems = [
  {
    id: 'dis1',
    header: 'Available Section',
    content: 'This section can be expanded and collapsed normally.',
  },
  {
    id: 'dis2',
    header: 'Disabled Section',
    content: 'This content is not accessible because the section is disabled.',
    disabled: true,
  },
  {
    id: 'dis3',
    header: 'Another Available Section',
    content:
      'This section can also be expanded. Notice that arrow key navigation skips the disabled section.',
  },
];
---

<PatternLayout
  title="Accordion - React"
  pattern="accordion"
  framework="react"
  tocItems={tocItems}
  locale={locale}
>
  <header class="mb-8">
    <h1 class="mb-4 text-3xl font-bold">Accordion</h1>
    <p class="text-muted-foreground text-lg">
      å‚ç›´ã«ç©ã¿é‡ã­ã‚‰ã‚ŒãŸã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªè¦‹å‡ºã—ã®ã‚»ãƒƒãƒˆã€‚å„è¦‹å‡ºã—ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒå±•é–‹ã•ã‚Œã¾ã™ã€‚
    </p>
    <a
      href="/patterns/accordion/llm.md"
      target="_blank"
      rel="noopener noreferrer"
      class="mt-4 inline-flex items-center gap-1.5 rounded-full border border-blue-200 bg-blue-50 px-3 py-1 text-sm text-blue-700 transition-colors hover:bg-blue-100 dark:border-blue-800 dark:bg-blue-950 dark:text-blue-300 dark:hover:bg-blue-900"
    >
      <span class="text-base">ğŸ¤–</span>
      AI å®Ÿè£…ã‚¬ã‚¤ãƒ‰
    </a>
  </header>

  <!-- Framework Selector -->
  <FrameworkTabs pattern="accordion" currentFramework="react" locale={locale} />

  <!-- Demo Section -->
  <section class="mb-12">
    <Heading level={2} id="demo" class="mb-4 text-xl font-semibold">{t('pattern.demo')}</Heading>

    <!-- Default (Single Expansion) -->
    <div class="mb-8">
      <h3 class="mb-3 text-lg font-medium">å˜ä¸€å±•é–‹ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰</h3>
      <p class="text-muted-foreground mb-4 text-sm">
        ä¸€åº¦ã«1ã¤ã®ãƒ‘ãƒãƒ«ã®ã¿å±•é–‹å¯èƒ½ã§ã™ã€‚æ–°ã—ã„ãƒ‘ãƒãƒ«ã‚’é–‹ãã¨ã€å‰ã«é–‹ã„ã¦ã„ãŸãƒ‘ãƒãƒ«ã¯é–‰ã˜ã¾ã™ã€‚
      </p>
      <div class="border-border bg-background rounded-lg border p-6">
        <Accordion client:load items={defaultItems} headingLevel={3} />
      </div>
    </div>

    <!-- Multiple Expansion -->
    <div class="mb-8">
      <h3 class="mb-3 text-lg font-medium">è¤‡æ•°å±•é–‹</h3>
      <p class="text-muted-foreground mb-4 text-sm">
        <code>allowMultiple</code> ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€è¤‡æ•°ã®ãƒ‘ãƒãƒ«ã‚’åŒæ™‚ã«å±•é–‹ã§ãã¾ã™ã€‚
      </p>
      <div class="border-border bg-background rounded-lg border p-6">
        <Accordion client:load items={multipleItems} allowMultiple={true} headingLevel={3} />
      </div>
    </div>

    <!-- Disabled Items -->
    <div>
      <h3 class="mb-3 text-lg font-medium">ç„¡åŠ¹ãªã‚¢ã‚¤ãƒ†ãƒ ä»˜ã</h3>
      <p class="text-muted-foreground mb-4 text-sm">
        å€‹ã€…ã®ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ã‚¢ã‚¤ãƒ†ãƒ ã‚’ç„¡åŠ¹åŒ–ã§ãã¾ã™ã€‚ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã¯ç„¡åŠ¹ãªã‚¢ã‚¤ãƒ†ãƒ ã‚’è‡ªå‹•çš„ã«ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™ã€‚
      </p>
      <div class="border-border bg-background rounded-lg border p-6">
        <Accordion client:load items={disabledItems} headingLevel={3} />
      </div>
    </div>
  </section>

  <!-- Accessibility Section -->
  <section class="mb-12">
    <Heading level={2} id="accessibility-features" class="mb-4 text-xl font-semibold"
      >{t('pattern.accessibility')}</Heading
    >
    <AccessibilityDocs />
  </section>

  <!-- Source Code Section -->
  <section class="mb-12">
    <Heading level={2} id="source-code" class="mb-4 text-xl font-semibold"
      >{t('pattern.sourceCode')}</Heading
    >
    <CodeBlock collapsible collapsedLines={5} code={sourceCode} lang="tsx" title="Accordion.tsx" />
  </section>

  <!-- Usage Section -->
  <section class="mb-12">
    <Heading level={2} id="usage" class="mb-4 text-xl font-semibold">{t('pattern.usage')}</Heading>
    <CodeBlock
      collapsible
      collapsedLines={5}
      code={`import { Accordion } from './Accordion';

const items = [
  {
    id: 'section1',
    header: 'First Section',
    content: 'Content for the first section...',
    defaultExpanded: true,
  },
  {
    id: 'section2',
    header: 'Second Section',
    content: 'Content for the second section...',
  },
];

function App() {
  return (
    <Accordion
      items={items}
      headingLevel={3}
      allowMultiple={false}
      onExpandedChange={(ids) => console.log('Expanded:', ids)}
    />
  );
}`}
      lang="tsx"
      title="Example"
    />
  </section>

  <!-- API Section -->
  <section class="mb-12">
    <Heading level={2} id="api" class="mb-4 text-xl font-semibold">{t('pattern.api')}</Heading>

    <h3 class="mb-3 text-lg font-medium">AccordionProps</h3>
    <ResponsiveTable class="mb-6">
      <table class="w-full border-collapse">
        <thead>
          <tr class="border-border border-b">
            <th class="py-2 pr-4 text-left">ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</th>
            <th class="py-2 pr-4 text-left">å‹</th>
            <th class="py-2 pr-4 text-left">ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ</th>
            <th class="py-2 text-left">èª¬æ˜</th>
          </tr>
        </thead>
        <tbody>
          <tr class="border-border border-b">
            <td class="py-2 pr-4"><code>items</code></td>
            <td class="text-muted-foreground py-2 pr-4">AccordionItem[]</td>
            <td class="text-muted-foreground py-2 pr-4">å¿…é ˆ</td>
            <td class="py-2">ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ã‚¢ã‚¤ãƒ†ãƒ ã®é…åˆ—</td>
          </tr>
          <tr class="border-border border-b">
            <td class="py-2 pr-4"><code>allowMultiple</code></td>
            <td class="text-muted-foreground py-2 pr-4">boolean</td>
            <td class="text-muted-foreground py-2 pr-4">false</td>
            <td class="py-2">è¤‡æ•°ã®ãƒ‘ãƒãƒ«ã®åŒæ™‚å±•é–‹ã‚’è¨±å¯</td>
          </tr>
          <tr class="border-border border-b">
            <td class="py-2 pr-4"><code>headingLevel</code></td>
            <td class="text-muted-foreground py-2 pr-4">2 | 3 | 4 | 5 | 6</td>
            <td class="text-muted-foreground py-2 pr-4">3</td>
            <td class="py-2">ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ç”¨ã®è¦‹å‡ºã—ãƒ¬ãƒ™ãƒ«</td>
          </tr>
          <tr class="border-border border-b">
            <td class="py-2 pr-4"><code>enableArrowKeys</code></td>
            <td class="text-muted-foreground py-2 pr-4">boolean</td>
            <td class="text-muted-foreground py-2 pr-4">true</td>
            <td class="py-2">çŸ¢å°ã‚­ãƒ¼ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æœ‰åŠ¹åŒ–</td>
          </tr>
          <tr class="border-border border-b">
            <td class="py-2 pr-4"><code>onExpandedChange</code></td>
            <td class="text-muted-foreground py-2 pr-4">(ids: string[]) =&gt; void</td>
            <td class="text-muted-foreground py-2 pr-4">-</td>
            <td class="py-2">å±•é–‹çŠ¶æ…‹ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯</td>
          </tr>
          <tr class="border-border border-b">
            <td class="py-2 pr-4"><code>className</code></td>
            <td class="text-muted-foreground py-2 pr-4">string</td>
            <td class="text-muted-foreground py-2 pr-4">""</td>
            <td class="py-2">è¿½åŠ ã®CSSã‚¯ãƒ©ã‚¹</td>
          </tr>
        </tbody>
      </table>
    </ResponsiveTable>

    <h3 class="mb-3 text-lg font-medium">AccordionItem</h3>
    <ResponsiveTable>
      <table class="w-full border-collapse">
        <thead>
          <tr class="border-border border-b">
            <th class="py-2 pr-4 text-left">ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</th>
            <th class="py-2 pr-4 text-left">å‹</th>
            <th class="py-2 pr-4 text-left">å¿…é ˆ</th>
            <th class="py-2 text-left">èª¬æ˜</th>
          </tr>
        </thead>
        <tbody>
          <tr class="border-border border-b">
            <td class="py-2 pr-4"><code>id</code></td>
            <td class="text-muted-foreground py-2 pr-4">string</td>
            <td class="text-muted-foreground py-2 pr-4">ã¯ã„</td>
            <td class="py-2">ã‚¢ã‚¤ãƒ†ãƒ ã®ä¸€æ„ã®è­˜åˆ¥å­</td>
          </tr>
          <tr class="border-border border-b">
            <td class="py-2 pr-4"><code>header</code></td>
            <td class="text-muted-foreground py-2 pr-4">ReactNode</td>
            <td class="text-muted-foreground py-2 pr-4">ã¯ã„</td>
            <td class="py-2">ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ãƒ˜ãƒƒãƒ€ãƒ¼ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</td>
          </tr>
          <tr class="border-border border-b">
            <td class="py-2 pr-4"><code>content</code></td>
            <td class="text-muted-foreground py-2 pr-4">ReactNode</td>
            <td class="text-muted-foreground py-2 pr-4">ã¯ã„</td>
            <td class="py-2">ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ãƒ‘ãƒãƒ«ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</td>
          </tr>
          <tr class="border-border border-b">
            <td class="py-2 pr-4"><code>disabled</code></td>
            <td class="text-muted-foreground py-2 pr-4">boolean</td>
            <td class="text-muted-foreground py-2 pr-4">ã„ã„ãˆ</td>
            <td class="py-2">ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ã‚¢ã‚¤ãƒ†ãƒ ã‚’ç„¡åŠ¹åŒ–</td>
          </tr>
          <tr class="border-border border-b">
            <td class="py-2 pr-4"><code>defaultExpanded</code></td>
            <td class="text-muted-foreground py-2 pr-4">boolean</td>
            <td class="text-muted-foreground py-2 pr-4">ã„ã„ãˆ</td>
            <td class="py-2">åˆæœŸã®å±•é–‹çŠ¶æ…‹</td>
          </tr>
        </tbody>
      </table>
    </ResponsiveTable>
  </section>

  <!-- Testing Section -->
  <section class="mb-12">
    <Heading level={2} id="testing" class="mb-4 text-xl font-semibold"
      >{t('pattern.testing')}</Heading
    >
    <TestingDocs />
    <div class="mt-6">
      <CodeBlock
        collapsible
        collapsedLines={5}
        code={testCode}
        lang="tsx"
        title="Accordion.test.tsx"
      />
    </div>
  </section>

  <!-- Resources -->
  <section>
    <Heading level={2} id="resources" class="mb-4 text-xl font-semibold"
      >{t('pattern.resources')}</Heading
    >
    <ul class="list-disc space-y-2 pl-6">
      <li>
        <ExternalLink
          href="https://www.w3.org/WAI/ARIA/apg/patterns/accordion/"
          class="text-primary hover:underline"
        >
          WAI-ARIA APG: Accordion ãƒ‘ã‚¿ãƒ¼ãƒ³
        </ExternalLink>
      </li>
      <li>
        <ExternalLink href="/patterns/accordion/llm.md" class="text-primary hover:underline">
          AI Implementation Guide (llm.md)
        </ExternalLink>
        <span class="text-muted-foreground text-sm">
          - ARIA specs, keyboard support, test checklist</span
        >
      </li>
    </ul>
  </section>
</PatternLayout>
