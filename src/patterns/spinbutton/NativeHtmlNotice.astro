---
import { ResponsiveTable } from '@/components/ui/table';
import { spinbuttonAccessibilityData } from './accessibility-data';
import type { Locale } from '@/i18n';
import { localize } from '@/lib/pattern-data/i18n';

interface Props {
  locale?: Locale;
}

const { locale = 'en' } = Astro.props;
const t = localize(locale);
const data = spinbuttonAccessibilityData;

// Native vs Custom translations
const nativeVsCustomTranslations = {
  en: {
    'Basic numeric input': 'Basic numeric input',
    'JavaScript disabled support': 'JavaScript disabled support',
    'Built-in validation': 'Built-in validation',
    'Custom button styling': 'Custom button styling',
    'Consistent cross-browser appearance': 'Consistent cross-browser appearance',
    'Custom step/large step behavior': 'Custom step/large step behavior',
    'No min/max limits': 'No min/max limits',
    Recommended: 'Recommended',
    'Not needed': 'Not needed',
    'Works natively': 'Works natively',
    'Requires fallback': 'Requires fallback',
    'Native support': 'Native support',
    'Manual implementation': 'Manual implementation',
    'Limited (browser-dependent)': 'Limited (browser-dependent)',
    'Full control': 'Full control',
    'Varies by browser': 'Varies by browser',
    Consistent: 'Consistent',
    'Basic step only': 'Basic step only',
    'PageUp/PageDown support': 'PageUp/PageDown support',
    'Requires omitting attributes': 'Requires omitting attributes',
    'Explicit undefined support': 'Explicit undefined support',
  },
  ja: {
    'Basic numeric input': '基本的な数値入力',
    'JavaScript disabled support': 'JavaScript 無効時のサポート',
    'Built-in validation': '組み込みバリデーション',
    'Custom button styling': 'カスタムボタンスタイリング',
    'Consistent cross-browser appearance': 'クロスブラウザで一貫した外観',
    'Custom step/large step behavior': 'カスタムステップ/大ステップの動作',
    'No min/max limits': '最小/最大値制限なし',
    Recommended: '推奨',
    'Not needed': '不要',
    'Works natively': 'ネイティブで動作',
    'Requires fallback': 'フォールバックが必要',
    'Native support': 'ネイティブサポート',
    'Manual implementation': '手動実装が必要',
    'Limited (browser-dependent)': '制限あり（ブラウザ依存）',
    'Full control': '完全に制御可能',
    'Varies by browser': 'ブラウザにより異なる',
    Consistent: '一貫性あり',
    'Basic step only': '基本的なステップのみ',
    'PageUp/PageDown support': 'PageUp/PageDown サポート',
    'Requires omitting attributes': '属性の省略が必要',
    'Explicit undefined support': '明示的な undefined サポート',
  },
};

const tr = (key: string) =>
  nativeVsCustomTranslations[locale][key as keyof (typeof nativeVsCustomTranslations)['en']] || key;

const sectionContent = {
  en: {
    title: 'Use Native HTML First',
    warning:
      'Before using this custom component, consider using native <code>&lt;input type="number"&gt;</code> elements.',
    description:
      'They provide built-in semantics, work without JavaScript, and have native browser validation.',
    codeExample: `<label for="quantity">Quantity</label>
<input type="number" id="quantity" value="1" min="0" max="100" step="1">`,
    whenToUse:
      'Use custom implementations only when you need custom styling that native elements cannot provide, or when you need specific interaction patterns not available with native inputs.',
    nativeHtml: 'Native HTML',
    customImpl: 'Custom Implementation',
    footnote:
      'The native <code>&lt;input type="number"&gt;</code> element provides built-in browser validation, form submission support, and accessible semantics. However, its appearance and spinner button styling varies significantly across browsers, making custom implementations preferable when visual consistency is required.',
  },
  ja: {
    title: 'ネイティブ HTML を優先',
    warning:
      'このカスタムコンポーネントを使用する前に、ネイティブの <code>&lt;input type="number"&gt;</code> 要素の使用を検討してください。',
    description:
      'ネイティブ要素は組み込みのセマンティクスを提供し、JavaScript なしで動作し、ネイティブのブラウザバリデーションを備えています。',
    codeExample: `<label for="quantity">数量</label>
<input type="number" id="quantity" value="1" min="0" max="100" step="1">`,
    whenToUse:
      'カスタム実装は、ネイティブ要素では提供できないカスタムスタイリングが必要な場合、またはネイティブ入力では利用できない特定のインタラクションパターンが必要な場合にのみ使用してください。',
    nativeHtml: 'ネイティブ HTML',
    customImpl: 'カスタム実装',
    footnote:
      'ネイティブの <code>&lt;input type="number"&gt;</code> 要素は、組み込みのブラウザバリデーション、フォーム送信サポート、アクセシブルなセマンティクスを提供します。ただし、その外観とスピナーボタンのスタイリングはブラウザ間で大きく異なるため、視覚的な一貫性が求められる場合はカスタム実装が望ましいです。',
  },
};

const content = sectionContent[locale];
---

<div class="border-primary mb-8 rounded-lg border-2 p-4">
  <h2 class="mb-2 flex items-center gap-2 text-lg font-bold">
    <span aria-hidden="true">&#x26A0;&#xFE0F;</span>
    {content.title}
  </h2>
  <p class="mb-4">
    <strong class="text-red-700 dark:text-red-400" set:html={content.warning} />
    {content.description}
  </p>
  <div class="bg-muted mb-4 rounded-md p-3">
    <pre class="m-0 overflow-x-auto text-sm"><code>{content.codeExample}</code></pre>
  </div>
  <p class="mb-4 text-sm">
    {content.whenToUse}
  </p>

  <ResponsiveTable>
    <table class="w-full border-collapse">
      <thead>
        <tr class="border-border border-b">
          <th class="py-2 pr-4 text-left">{locale === 'ja' ? 'ユースケース' : 'Use Case'}</th>
          <th class="py-2 pr-4 text-left">{content.nativeHtml}</th>
          <th class="py-2 text-left">{content.customImpl}</th>
        </tr>
      </thead>
      <tbody>
        {
          data.nativeVsCustom?.map((row) => {
            const feature = row.feature ? tr(t(row.feature)) : '';
            const native = row.native ? tr(t(row.native)) : '';
            const custom = row.custom ? tr(t(row.custom)) : '';
            return (
              <tr class="border-border border-b">
                <td class="py-2 pr-4">{feature}</td>
                <td class="py-2 pr-4">
                  {native === 'Recommended' ||
                  native === 'Works natively' ||
                  native === 'Native support' ? (
                    <b class="text-green-700 dark:text-green-400">{native}</b>
                  ) : (
                    native
                  )}
                </td>
                <td class="py-2">
                  {custom === 'Full control' ||
                  custom === 'Consistent' ||
                  custom === 'PageUp/PageDown support' ||
                  custom === 'Explicit undefined support' ? (
                    <b class="text-green-700 dark:text-green-400">{custom}</b>
                  ) : (
                    custom
                  )}
                </td>
              </tr>
            );
          })
        }
      </tbody>
    </table>
  </ResponsiveTable>
  <p class="text-muted-foreground mt-3 text-xs" set:html={content.footnote} />
</div>
