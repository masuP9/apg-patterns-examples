---
import ExternalLink from '@/components/ui/ExternalLink.astro';
import { ResponsiveTable } from '@/components/ui/table';
---

<div class="prose dark:prose-invert max-w-none">
  <p class="text-muted-foreground mb-4">
    APG準拠のARIA属性、キーボード操作、テキスト入力処理、およびアクセシビリティ要件を検証するテストです。
  </p>

  <h3 class="mb-3 text-lg font-medium">テストカテゴリ</h3>

  <h4 class="mb-2 flex items-center gap-2 font-medium">
    <span class="inline-block h-3 w-3 rounded-full bg-red-500"></span>
    高優先度: ARIA属性
  </h4>
  <ResponsiveTable class="mb-6">
    <table class="w-full border-collapse">
      <thead>
        <tr class="border-border border-b">
          <th class="py-2 pr-4 text-left">テスト</th>
          <th class="py-2 text-left">説明</th>
        </tr>
      </thead>
      <tbody>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>role="spinbutton"</code></td>
          <td class="py-2">要素がspinbuttonロールを持つ</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>aria-valuenow</code></td>
          <td class="py-2">現在の値が正しく設定され、更新される</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>aria-valuemin</code></td>
          <td class="py-2">最小値が定義されている場合のみ設定される</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>aria-valuemax</code></td>
          <td class="py-2">最大値が定義されている場合のみ設定される</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>aria-valuetext</code></td>
          <td class="py-2">人間が読めるテキストが提供された場合に設定される</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>aria-disabled</code></td>
          <td class="py-2">無効状態が設定された場合に反映される</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>aria-readonly</code></td>
          <td class="py-2">読み取り専用状態が設定された場合に反映される</td>
        </tr>
      </tbody>
    </table>
  </ResponsiveTable>

  <h4 class="mb-2 flex items-center gap-2 font-medium">
    <span class="inline-block h-3 w-3 rounded-full bg-red-500"></span>
    高優先度: アクセシブル名
  </h4>
  <ResponsiveTable class="mb-6">
    <table class="w-full border-collapse">
      <thead>
        <tr class="border-border border-b">
          <th class="py-2 pr-4 text-left">テスト</th>
          <th class="py-2 text-left">説明</th>
        </tr>
      </thead>
      <tbody>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>aria-label</code></td>
          <td class="py-2">aria-label属性によるアクセシブル名</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>aria-labelledby</code></td>
          <td class="py-2">外部要素参照によるアクセシブル名</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>visible label</code></td>
          <td class="py-2">視覚的なラベルがアクセシブル名を提供</td>
        </tr>
      </tbody>
    </table>
  </ResponsiveTable>

  <h4 class="mb-2 flex items-center gap-2 font-medium">
    <span class="inline-block h-3 w-3 rounded-full bg-red-500"></span>
    高優先度: キーボード操作
  </h4>
  <ResponsiveTable class="mb-6">
    <table class="w-full border-collapse">
      <thead>
        <tr class="border-border border-b">
          <th class="py-2 pr-4 text-left">テスト</th>
          <th class="py-2 text-left">説明</th>
        </tr>
      </thead>
      <tbody>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>Arrow Up</code></td>
          <td class="py-2">値を1ステップ増加させる</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>Arrow Down</code></td>
          <td class="py-2">値を1ステップ減少させる</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>Home</code></td>
          <td class="py-2">最小値に設定（最小値が定義されている場合のみ）</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>End</code></td>
          <td class="py-2">最大値に設定（最大値が定義されている場合のみ）</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>Page Up/Down</code></td>
          <td class="py-2">大きなステップで値を増加/減少させる</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>Boundary clamping</code></td>
          <td class="py-2">値が最小値/最大値の範囲を超えない</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>Disabled state</code></td>
          <td class="py-2">無効状態の場合、キーボード操作が無効になる</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>Read-only state</code></td>
          <td class="py-2">矢印キーはブロック、Home/Endは許可</td>
        </tr>
      </tbody>
    </table>
  </ResponsiveTable>

  <h4 class="mb-2 flex items-center gap-2 font-medium">
    <span class="inline-block h-3 w-3 rounded-full bg-red-500"></span>
    高優先度: ボタン操作
  </h4>
  <ResponsiveTable class="mb-6">
    <table class="w-full border-collapse">
      <thead>
        <tr class="border-border border-b">
          <th class="py-2 pr-4 text-left">テスト</th>
          <th class="py-2 text-left">説明</th>
        </tr>
      </thead>
      <tbody>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>Increment click</code></td>
          <td class="py-2">増加ボタンのクリックで値が増加する</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>Decrement click</code></td>
          <td class="py-2">減少ボタンのクリックで値が減少する</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>Button labels</code></td>
          <td class="py-2">ボタンにアクセシブルなラベルがある</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>Disabled/read-only</code></td>
          <td class="py-2">無効または読み取り専用の場合、ボタンがブロックされる</td>
        </tr>
      </tbody>
    </table>
  </ResponsiveTable>

  <h4 class="mb-2 flex items-center gap-2 font-medium">
    <span class="inline-block h-3 w-3 rounded-full bg-red-500"></span>
    高優先度: フォーカス管理
  </h4>
  <ResponsiveTable class="mb-6">
    <table class="w-full border-collapse">
      <thead>
        <tr class="border-border border-b">
          <th class="py-2 pr-4 text-left">テスト</th>
          <th class="py-2 text-left">説明</th>
        </tr>
      </thead>
      <tbody>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>tabindex="0"</code></td>
          <td class="py-2">入力欄がフォーカス可能である</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>tabindex="-1"</code></td>
          <td class="py-2">無効状態の場合、入力欄がフォーカス不可になる</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>Button tabindex</code></td>
          <td class="py-2">ボタンがtabindex="-1"を持つ（タブ順序に含まれない）</td>
        </tr>
      </tbody>
    </table>
  </ResponsiveTable>

  <h4 class="mb-2 flex items-center gap-2 font-medium">
    <span class="inline-block h-3 w-3 rounded-full bg-yellow-500"></span>
    中優先度: テキスト入力
  </h4>
  <ResponsiveTable class="mb-6">
    <table class="w-full border-collapse">
      <thead>
        <tr class="border-border border-b">
          <th class="py-2 pr-4 text-left">テスト</th>
          <th class="py-2 text-left">説明</th>
        </tr>
      </thead>
      <tbody>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>inputmode="numeric"</code></td>
          <td class="py-2">モバイルで数値キーボードを使用</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>Valid input</code></td>
          <td class="py-2">有効なテキスト入力時にaria-valuenowが更新される</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>Invalid input</code></td>
          <td class="py-2">無効な入力でフォーカスを失った際に前の値に戻る</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>Clamp on blur</code></td>
          <td class="py-2">フォーカスを失った際にステップと最小値/最大値に正規化される</td>
        </tr>
      </tbody>
    </table>
  </ResponsiveTable>

  <h4 class="mb-2 flex items-center gap-2 font-medium">
    <span class="inline-block h-3 w-3 rounded-full bg-yellow-500"></span>
    中優先度: IME変換
  </h4>
  <ResponsiveTable class="mb-6">
    <table class="w-full border-collapse">
      <thead>
        <tr class="border-border border-b">
          <th class="py-2 pr-4 text-left">テスト</th>
          <th class="py-2 text-left">説明</th>
        </tr>
      </thead>
      <tbody>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>During composition</code></td>
          <td class="py-2">IME変換中は値が更新されない</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>On composition end</code></td>
          <td class="py-2">変換完了時に値が更新される</td>
        </tr>
      </tbody>
    </table>
  </ResponsiveTable>

  <h4 class="mb-2 flex items-center gap-2 font-medium">
    <span class="inline-block h-3 w-3 rounded-full bg-yellow-500"></span>
    中優先度: エッジケース
  </h4>
  <ResponsiveTable class="mb-6">
    <table class="w-full border-collapse">
      <thead>
        <tr class="border-border border-b">
          <th class="py-2 pr-4 text-left">テスト</th>
          <th class="py-2 text-left">説明</th>
        </tr>
      </thead>
      <tbody>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>decimal values</code></td>
          <td class="py-2">小数ステップ値を正しく処理する</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>no min/max</code></td>
          <td class="py-2">最小値/最大値がない場合、無制限の値を許可</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>clamp to min</code></td>
          <td class="py-2">最小値を下回るdefaultValueが最小値にクランプされる</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>clamp to max</code></td>
          <td class="py-2">最大値を上回るdefaultValueが最大値にクランプされる</td>
        </tr>
      </tbody>
    </table>
  </ResponsiveTable>

  <h4 class="mb-2 flex items-center gap-2 font-medium">
    <span class="inline-block h-3 w-3 rounded-full bg-yellow-500"></span>
    中優先度: コールバック
  </h4>
  <ResponsiveTable class="mb-6">
    <table class="w-full border-collapse">
      <thead>
        <tr class="border-border border-b">
          <th class="py-2 pr-4 text-left">テスト</th>
          <th class="py-2 text-left">説明</th>
        </tr>
      </thead>
      <tbody>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>onValueChange</code></td>
          <td class="py-2">値の変更時に新しい値でコールバックが呼ばれる</td>
        </tr>
      </tbody>
    </table>
  </ResponsiveTable>

  <h4 class="mb-2 flex items-center gap-2 font-medium">
    <span class="inline-block h-3 w-3 rounded-full bg-green-500"></span>
    低優先度: HTML属性の継承
  </h4>
  <ResponsiveTable class="mb-6">
    <table class="w-full border-collapse">
      <thead>
        <tr class="border-border border-b">
          <th class="py-2 pr-4 text-left">テスト</th>
          <th class="py-2 text-left">説明</th>
        </tr>
      </thead>
      <tbody>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>className</code></td>
          <td class="py-2">カスタムクラスがコンテナに適用される</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>id</code></td>
          <td class="py-2">ID属性が正しく設定される</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>data-*</code></td>
          <td class="py-2">データ属性が継承される</td>
        </tr>
      </tbody>
    </table>
  </ResponsiveTable>

  <h3 class="mb-3 text-lg font-medium">テストツール</h3>
  <ul class="mb-6 list-disc space-y-2 pl-6">
    <li>
      <ExternalLink href="https://playwright.dev/" class="text-primary hover:underline"
        >Playwright</ExternalLink
      >
      - E2Eテスト（178件のクロスフレームワークテスト） -
      <ExternalLink
        href="https://github.com/masuP9/apg-patterns-examples/blob/main/e2e/spinbutton.spec.ts"
        class="text-primary hover:underline"
      >
        テストファイルを見る
      </ExternalLink>
    </li>
    <li>
      <strong>React:</strong>
      <ExternalLink
        href="https://testing-library.com/docs/react-testing-library/intro/"
        class="text-primary hover:underline"
      >
        React Testing Library
      </ExternalLink>
    </li>
    <li>
      <strong>Vue:</strong>
      <ExternalLink
        href="https://testing-library.com/docs/vue-testing-library/intro/"
        class="text-primary hover:underline"
      >
        Vue Testing Library
      </ExternalLink>
    </li>
    <li>
      <strong>Svelte:</strong>
      <ExternalLink
        href="https://testing-library.com/docs/svelte-testing-library/intro/"
        class="text-primary hover:underline"
      >
        Svelte Testing Library
      </ExternalLink>
    </li>
    <li>
      <strong>Astro:</strong> Web Componentのユニットテスト用にVitestとJSDOMを使用
    </li>
    <li>
      <strong>アクセシビリティ:</strong>
      <ExternalLink
        href="https://github.com/dequelabs/axe-core"
        class="text-primary hover:underline"
      >
        axe-core
      </ExternalLink>
    </li>
  </ul>
</div>
