---
import { ResponsiveTable } from '@/components/ui/table';
---

<div class="prose dark:prose-invert max-w-none">
  <p class="text-muted-foreground mb-4">
    テストはARIA構造、キーボードナビゲーション、フォーカス管理、ポインターインタラクション全体でAPG準拠を検証します。
    Window Splitterコンポーネントは2層のテスト戦略を使用します。
  </p>

  <h3 class="mb-3 text-lg font-medium">テスト戦略</h3>

  <div class="bg-muted/50 mb-6 rounded-lg p-4">
    <h4 class="mb-2 font-medium">ユニットテスト (Container API / Testing Library)</h4>
    <p class="text-muted-foreground mb-2 text-sm">
      コンポーネントのHTML出力と基本的なインタラクションを検証します。
      正しいテンプレートレンダリングとARIA属性を確保します。
    </p>
    <ul class="text-muted-foreground list-disc space-y-1 pl-6 text-sm">
      <li>ARIA構造 (role, aria-valuenow, aria-controls)</li>
      <li>キーボードインタラクション (矢印キー, Home/End, Enter)</li>
      <li>折り畳み/展開機能</li>
      <li>RTLサポート</li>
      <li>無効/読み取り専用状態</li>
    </ul>
  </div>

  <div class="bg-muted/50 mb-6 rounded-lg p-4">
    <h4 class="mb-2 font-medium">E2Eテスト (Playwright)</h4>
    <p class="text-muted-foreground mb-2 text-sm">
      ポインターインタラクションを含む実際のブラウザ環境でのコンポーネント動作を検証します。
    </p>
    <ul class="text-muted-foreground list-disc space-y-1 pl-6 text-sm">
      <li>ドラッグによるリサイズ</li>
      <li>Tabナビゲーション全体でのフォーカス管理</li>
      <li>フレームワーク間の一貫性</li>
      <li>ビジュアル状態 (CSSカスタムプロパティの更新)</li>
    </ul>
  </div>

  <h3 class="mb-3 text-lg font-medium">テストカテゴリ</h3>

  <h4 class="mb-2 flex items-center gap-2 font-medium">
    <span class="inline-block h-3 w-3 rounded-full bg-red-500"></span>
    高優先度: ARIA構造（Unit + E2E）
  </h4>
  <ResponsiveTable class="mb-6">
    <table class="w-full border-collapse">
      <thead>
        <tr class="border-border border-b">
          <th class="py-2 pr-4 text-left">テスト</th>
          <th class="py-2 text-left">説明</th>
        </tr>
      </thead>
      <tbody>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>role="separator"</code></td>
          <td class="py-2">スプリッターがseparatorロールを持つ</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>aria-valuenow</code></td>
          <td class="py-2">プライマリペインのサイズ（パーセンテージ 0-100）</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>aria-valuemin/max</code></td>
          <td class="py-2">最小値と最大値が設定されている</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>aria-controls</code></td>
          <td class="py-2">プライマリ（および任意でセカンダリ）ペインを参照</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>aria-orientation</code></td>
          <td class="py-2">垂直スプリッターの場合は "vertical" に設定</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>aria-disabled</code></td>
          <td class="py-2">無効時は "true" に設定</td>
        </tr>
      </tbody>
    </table>
  </ResponsiveTable>

  <h4 class="mb-2 flex items-center gap-2 font-medium">
    <span class="inline-block h-3 w-3 rounded-full bg-red-500"></span>
    高優先度: キーボードインタラクション（Unit + E2E）
  </h4>
  <ResponsiveTable class="mb-6">
    <table class="w-full border-collapse">
      <thead>
        <tr class="border-border border-b">
          <th class="py-2 pr-4 text-left">テスト</th>
          <th class="py-2 text-left">説明</th>
        </tr>
      </thead>
      <tbody>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>ArrowRight/Left</code></td>
          <td class="py-2">水平スプリッターを移動（増加/減少）</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>ArrowUp/Down</code></td>
          <td class="py-2">垂直スプリッターを移動（増加/減少）</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>方向制限</code></td>
          <td class="py-2">間違った方向のキーは無効</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>Shift+Arrow</code></td>
          <td class="py-2">大きなステップで移動</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>Home/End</code></td>
          <td class="py-2">最小/最大位置に移動</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>Enter (折り畳み)</code></td>
          <td class="py-2">0に折り畳む</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>Enter (展開)</code></td>
          <td class="py-2">以前の位置に復元</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>RTLサポート</code></td>
          <td class="py-2">RTLモードではArrowLeft/Rightが反転</td>
        </tr>
      </tbody>
    </table>
  </ResponsiveTable>

  <h4 class="mb-2 flex items-center gap-2 font-medium">
    <span class="inline-block h-3 w-3 rounded-full bg-red-500"></span>
    高優先度: フォーカス管理（Unit + E2E）
  </h4>
  <ResponsiveTable class="mb-6">
    <table class="w-full border-collapse">
      <thead>
        <tr class="border-border border-b">
          <th class="py-2 pr-4 text-left">テスト</th>
          <th class="py-2 text-left">説明</th>
        </tr>
      </thead>
      <tbody>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>tabindex="0"</code></td>
          <td class="py-2">スプリッターがフォーカス可能</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>tabindex="-1"</code></td>
          <td class="py-2">無効なスプリッターはフォーカス不可</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>readonly フォーカス可能</code></td>
          <td class="py-2">読み取り専用スプリッターはフォーカス可能だが操作不可</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>折り畳み後のフォーカス</code></td>
          <td class="py-2">フォーカスはスプリッターに残る</td>
        </tr>
      </tbody>
    </table>
  </ResponsiveTable>

  <h4 class="mb-2 flex items-center gap-2 font-medium">
    <span class="inline-block h-3 w-3 rounded-full bg-yellow-500"></span>
    中優先度: ポインターインタラクション（E2E）
  </h4>
  <ResponsiveTable class="mb-6">
    <table class="w-full border-collapse">
      <thead>
        <tr class="border-border border-b">
          <th class="py-2 pr-4 text-left">テスト</th>
          <th class="py-2 text-left">説明</th>
        </tr>
      </thead>
      <tbody>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>ドラッグでリサイズ</code></td>
          <td class="py-2">ドラッグ中に位置が更新される</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>クリックでフォーカス</code></td>
          <td class="py-2">クリックでスプリッターにフォーカス</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>無効時は無応答</code></td>
          <td class="py-2">無効なスプリッターはポインターを無視</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>読み取り専用時は無応答</code></td>
          <td class="py-2">読み取り専用スプリッターはポインターを無視</td>
        </tr>
      </tbody>
    </table>
  </ResponsiveTable>

  <h4 class="mb-2 flex items-center gap-2 font-medium">
    <span class="inline-block h-3 w-3 rounded-full bg-yellow-500"></span>
    中優先度: アクセシビリティ（E2E）
  </h4>
  <ResponsiveTable class="mb-6">
    <table class="w-full border-collapse">
      <thead>
        <tr class="border-border border-b">
          <th class="py-2 pr-4 text-left">テスト</th>
          <th class="py-2 text-left">説明</th>
        </tr>
      </thead>
      <tbody>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>axe違反</code></td>
          <td class="py-2">WCAG 2.1 AA違反なし</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>折り畳み状態</code></td>
          <td class="py-2">折り畳み時に違反なし</td>
        </tr>
        <tr class="border-border border-b">
          <td class="py-2 pr-4"><code>無効状態</code></td>
          <td class="py-2">無効時に違反なし</td>
        </tr>
      </tbody>
    </table>
  </ResponsiveTable>

  <h3 class="mb-3 text-lg font-medium">テストの実行</h3>

  <div class="bg-muted/50 mb-6 rounded-lg p-4">
    <h4 class="mb-2 font-medium">ユニットテスト</h4>
    <pre
      class="text-muted-foreground overflow-x-auto text-sm"><code># 全てのWindow Splitterユニットテストを実行
npx vitest run src/patterns/window-splitter/

# フレームワーク別テストを実行
npm run test:react -- WindowSplitter.test.tsx
npm run test:vue -- WindowSplitter.test.vue.ts
npm run test:svelte -- WindowSplitter.test.svelte.ts
npm run test:astro</code></pre>
  </div>

  <div class="bg-muted/50 mb-6 rounded-lg p-4">
    <h4 class="mb-2 font-medium">E2Eテスト</h4>
    <pre
      class="text-muted-foreground overflow-x-auto text-sm"><code># 全てのWindow Splitter E2Eテストを実行
npm run test:e2e -- window-splitter.spec.ts

# UIモードで実行
npm run test:e2e:ui -- window-splitter.spec.ts</code></pre>
  </div>
</div>
